<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wzmtr.eam.mapper.equipment.EquipmentMapper">

    <select id="listTrainRegion" resultType="com.wzmtr.eam.dto.res.basic.RegionResDTO">
        SELECT REC_ID, EQUIP_CODE as NODE_CODE, EQUIP_NAME as NODE_NAME
        FROM T_EQUIPMENT
        WHERE MAJOR_CODE='07' and APPROVAL_STATUS ='30'
        AND regexp_like(asciistr(EQUIP_NAME),'^S0')
        <if test="lineCode!=null and lineCode!=''">
            AND USE_LINE_NO=#{lineCode}
        </if>
        <if test="lineCode==null or lineCode==''">
            AND USE_LINE_NO='01'
        </if>
        order by EQUIP_NAME asc
    </select>

    <select id="listLine" resultType="com.wzmtr.eam.dto.res.basic.RegionResDTO">
        SELECT ITEM_CODE as REC_ID, 'root' as PARENT_NODE_REC_ID, ITEM_CODE as NODE_CODE, ITEM_CNAME as NODE_NAME, ITEM_CODE as LINE_CODE
        FROM SYS_DICT
        WHERE CODESET_CODE='line'
        ORDER BY ITEM_CODE ASC
    </select>

    <select id="listRegion" resultType="com.wzmtr.eam.dto.res.basic.RegionResDTO">
        SELECT REC_ID, PARENT_NODE_REC_ID, NODE_CODE, NODE_NAME, LINE_CODE
        FROM SYS_REGION
        WHERE DELETE_FLAG='0' and REC_STATUS='10' and LINE_CODE=#{lineCode}
        <if test="regionCode!=null and regionCode!=''">
            and PARENT_NODE_REC_ID=#{recId}
        </if>
        <if test="regionCode==null or regionCode==''">
            and NODE_LEVEL=2
        </if>
        ORDER BY NODE_CODE ASC
    </select>

    <select id="listCarRegion" resultType="com.wzmtr.eam.dto.res.basic.RegionResDTO">
        SELECT REC_ID, #{recId} as PARENT_NODE_REC_ID, EQUIP_CODE as NODE_CODE, EQUIP_NAME as NODE_NAME, USE_LINE_NO as LINE_CODE
        FROM T_EQUIPMENT
        WHERE MAJOR_CODE='07' and APPROVAL_STATUS ='30'
        AND USE_LINE_NO =#{lineCode}
        order by EQUIP_CODE  asc
    </select>

    <select id="listEquipmentCategory" resultType="com.wzmtr.eam.dto.res.basic.EquipmentCategoryResDTO">
        select REC_ID, PARENT_NODE_REC_ID, NODE_CODE, NODE_NAME, #{lineCode} as LINE_CODE,  #{regionCode} as REGION_CODE
        from T_EQUIPMENT_CATEGORY
        where DELETE_FLAG='0' and REC_STATUS='10'
        <if test="equipmentCategoryCode!=null and equipmentCategoryCode!=''">
            and PARENT_NODE_REC_ID=#{recId}
        </if>
        <if test="equipmentCategoryCode==null or equipmentCategoryCode==''">
            and PARENT_NODE_REC_ID='0'
        </if>
        ORDER BY NODE_CODE ASC
    </select>

    <sql id="equip-cols">
        SELECT
        REC_ID	as "recId",  <!-- 记录编号 -->
        COMPANY_CODE	as "companyCode",  <!-- 公司代码 -->
        COMPANY_NAME	as "companyName",  <!-- 公司名称 -->
        DEPT_CODE	as "deptCode",  <!-- 部门代码 -->
        DEPT_NAME	as "deptName",  <!-- 部门名称 -->
        EQUIP_CODE	as "equipCode",  <!-- 设备编码 -->
        EQUIP_NAME	as "equipName",  <!-- 设备名称 -->
        MAJOR_CODE	as "majorCode",  <!-- 专业代码 -->
        MAJOR_NAME	as "majorName",  <!-- 专业名称 -->
        SYSTEM_CODE	as "systemCode",  <!-- 系统代码 -->
        SYSTEM_NAME	as "systemName",  <!-- 系统名称 -->
        EQUIP_TYPE_CODE	as "equipTypeCode",  <!-- 设备分类代码 -->
        EQUIP_TYPE_NAME	as "equipTypeName",  <!-- 设备分类名称 -->
        SPECIAL_EQUIP_FLAG	as "specialEquipFlag",  <!-- 特种设备标识 -->
        OTHER_EQUIP_FLAG	as "otherEquipFlag",  <!-- 其他设备标识 -->
        SOURCE_KIND	as "sourceKind",  <!-- 设备来源 -->
        BOM_TYPE	as "bomType",  <!-- BOM类型 -->
        MANUFACTURE	as "manufacture",  <!-- 生产厂家 -->
        ORDER_NO	as "orderNo",  <!-- 合同号 -->
        ORDER_NAME	as "orderName",  <!-- 合同名称 -->
        MAT_SPECIFI	as "matSpecifi",  <!-- 型号规格 -->
        BRAND	as "brand",  <!-- 品牌 -->
        MANUFACTURE_DATE	as "manufactureDate",  <!-- 出厂日期 -->
        MANUFACTURE_NO	as "manufactureNo",  <!-- 出厂编号 -->
        START_USE_DATE	as "startUseDate",  <!-- 开始使用日期 -->
        END_USE_TIME	as "endUseTime",  <!-- 停止使用日期 -->
        OTHER_FEATURE	as "otherFeature",  <!-- 其它特征参数 -->
        MEASURE_UNIT	as "measureUnit",  <!-- 计量单位 -->
        QUANTITY	as "quantity",  <!-- 数量 -->
        IN_ACCOUNT_TIME	as "inAccountTime",  <!-- 进设备台帐时间 -->
        PICK_NO	as "pickNo",  <!-- 领用人工号 -->
        PICK_NAME	as "pickName",  <!-- 领用人姓名 -->
        EQUIP_STATUS	as "equipStatus",  <!-- 设备状态 -->
        SOURCE_APP_NO	as "sourceAppNo",  <!-- 来源单号 -->
        SOURCE_SUB_NO	as "sourceSubNo",  <!-- 来源明细号 -->
        SOURCE_REC_ID	as "sourceRecId",  <!-- 来源记录编号 -->
        INSTALL_DEALER	as "installDealer",  <!-- 安装单位 -->
        DOC_ID	as "docId",  <!-- 附件编号 -->
        ORIGIN_LINE_NO	as "originLineNo",  <!-- 来源线别代码 -->
        ORIGIN_LINE_NAME	as "originLineName",  <!-- 来源线别名称 -->
        ORIGIN_SEG_NO	as "originSegNo",  <!-- 来源线段代码 -->
        ORIGIN_SEG_NAME	as "originSegName",  <!-- 来源线段名称 -->
        USE_LINE_NO	as "useLineNo",  <!-- 应用线别代码 -->
        USE_LINE_NAME	as "useLineName",  <!-- 应用线别 -->
        USE_SEG_NO	as "useSegNo",  <!-- 应用线段代码 -->
        USE_SEG_NAME	as "useSegName",  <!-- 应用线段 -->
        POSITION1_CODE	as "position1Code",  <!-- 位置一 -->
        POSITION1_NAME	as "position1Name",  <!-- 位置一名称 -->
        POSITION2_CODE	as "position2Code",  <!-- 位置二 -->
        POSITION2_NAME	as "position2Name",  <!-- 位置二名称 -->
        POSITION3	as "position3",  <!-- 位置三 -->
        POSITION_REMARK	as "positionRemark",  <!-- 位置补充说明 -->
        TOTAL_MILES	as "totalMiles",  <!-- 走行里程 -->
        REMARK	as "remark",  <!-- 备注 -->
        APPROVAL_STATUS	as "approvalStatus",  <!-- 审批状态 -->
        WORK_FLOW_INST_ID	as "workFlowInstId",  <!-- 工作流实例ID -->
        WORK_FLOW_INST_STATUS	as "workFlowInstStatus",  <!-- 工作流实例状态 -->
        VERIFY_DATE	as "verifyDate",  <!-- 特种设备检测日期 -->
        VERIFY_VALIDITY_DATE	as "verifyValidityDate",  <!-- 特种设备检测有效期 -->
        REC_CREATOR	as "recCreator",  <!-- 创建者 -->
        REC_CREATE_TIME	as "recCreateTime",  <!-- 创建时间 -->
        REC_REVISOR	as "recRevisor",  <!-- 修改者 -->
        REC_REVISE_TIME	as "recReviseTime",  <!-- 修改时间 -->
        REC_DELETOR	as "recDeletor",  <!-- 删除者 -->
        REC_DELETE_TIME	as "recDeleteTime",  <!-- 删除时间 -->
        DELETE_FLAG	as "deleteFlag",  <!-- 删除标志 -->
        ARCHIVE_FLAG	as "archiveFlag",  <!-- 归档标记 -->
        REC_STATUS	as "recStatus",  <!-- 记录状态 -->
        EXT1	as "ext1",  <!-- 扩展字段1 -->
        EXT2	as "ext2",  <!-- 扩展字段2 -->
        EXT3	as "ext3",  <!-- 扩展字段3 -->
        EXT4	as "ext4",  <!-- 扩展字段4 -->
        EXT5	as "ext5" <!-- 扩展字段5 -->
    </sql>

    <select id="pageEquipment" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        <include refid="equip-cols"/>
        FROM T_EQUIPMENT WHERE 1=1 AND APPROVAL_STATUS='30' AND DELETE_FLAG='0'
        <if test="equipCode!=null and equipCode!=''">
            and EQUIP_CODE like '%' || #{equipCode} || '%'
        </if>
        <if test="equipName!=null and equipName!=''">
            and EQUIP_NAME like '%' || #{equipName} || '%'
        </if>
        <if test="useLineNo!=null and useLineNo!=''">
            and USE_LINE_NO=#{useLineNo}
        </if>
        <if test="useLineNo==null or useLineNo==''">
            and USE_LINE_NO='01'
        </if>
        <if test="useSegNo!=null and useSegNo!=''">
            and USE_SEG_NO=#{useSegNo}
        </if>
        <if test="position1Code!=null and position1Code!=''">
            and POSITION1_CODE=#{position1Code}
        </if>
        <if test="brand!=null and brand!=''">
            and BRAND=#{brand}
        </if>
        <if test="manufacture!=null and manufacture!=''">
            and MANUFACTURE=#{manufacture}
        </if>
        <if test="manufacture!=null and manufacture!=''">
            and MANUFACTURE=#{manufacture}
        </if>
        <if test="startTime!=null and startTime!=''">
            and MANUFACTURE_DATE>=#{startTime}
        </if>
        <if test="endTime!=null and endTime!=''">
            and #{endTime}>=MANUFACTURE_DATE
        </if>
        <if test="majorCode!=null and majorCode!=''">
            and MAJOR_CODE=#{majorCode}
        </if>
        <if test="majors!=null and majors.size()>0">
            and MAJOR_CODE IN (
            <foreach collection="majors" index="index" item="major" separator=",">
                #{major}
            </foreach>
            )
        </if>
        <if test="systemCode!=null and systemCode!=''">
            and SYSTEM_CODE=#{systemCode}
        </if>
        <if test="equipTypeCode!=null and equipTypeCode!=''">
            and EQUIP_TYPE_CODE=#{equipTypeCode}
        </if>
        ORDER BY EQUIP_NAME ASC
    </select>

    <select id="pageEquipmentByRoom" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        SELECT t1.*
        FROM T_EQUIPMENT t1
        LEFT JOIN T_EQUIPMENT_ROOM_RELATION t2 ON t1.REC_ID=t2.EQUIPMENT_ID
        LEFT JOIN T_EQUIPMENT_ROOM t3 ON t2.ROOM_ID=t3.REC_ID
        WHERE 1=1
        <if test="equipCode!=null and equipCode!=''">
            and t1.EQUIP_CODE like '%' || #{equipCode} || '%'
        </if>
        <if test="equipName!=null and equipName!=''">
            and t1.EQUIP_NAME like '%' || #{equipName} || '%'
        </if>
        <if test="majorCode!=null and majorCode!=''">
            and t1.MAJOR_CODE=#{majorCode}
        </if>
        <if test="systemCode!=null and systemCode!=''">
            and t1.SYSTEM_CODE=#{systemCode}
        </if>
        and t3.REC_ID=#{roomId}
    </select>



    <select id="allList" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        <include refid="equip-cols"/>
        FROM T_EQUIPMENT WHERE 1=1 AND APPROVAL_STATUS='30' AND DELETE_FLAG='0'
        <if test="equipCode!=null and equipCode!=''">
            and EQUIP_CODE like '%' || #{equipCode} || '%'
        </if>
        <if test="equipName!=null and equipName!=''">
            and EQUIP_NAME like '%' || #{equipName} || '%'
        </if>
<!--        <if test="useLineNo!=null and useLineNo!=''">
            and USE_LINE_NO=#{useLineNo}
        </if>-->
        and USE_LINE_NO='01'
        <if test="useSegNo!=null and useSegNo!=''">
            and USE_SEG_NO=#{useSegNo}
        </if>
        <if test="position1Code!=null and position1Code!=''">
            and POSITION1_CODE=#{position1Code}
        </if>
        <if test="brand!=null and brand!=''">
            and BRAND=#{brand}
        </if>
        <if test="manufacture!=null and manufacture!=''">
            and MANUFACTURE=#{manufacture}
        </if>
        <if test="manufacture!=null and manufacture!=''">
            and MANUFACTURE=#{manufacture}
        </if>
        <if test="startTime!=null and startTime!=''">
            and MANUFACTURE_DATE>=#{startTime}
        </if>
        <if test="endTime!=null and endTime!=''">
            and #{endTime}>=MANUFACTURE_DATE
        </if>
        <if test="majorCode!=null and majorCode!=''">
            and MAJOR_CODE=#{majorCode}
        </if>
        <if test="systemCode!=null and systemCode!=''">
            and SYSTEM_CODE=#{systemCode}
        </if>
        <if test="equipTypeCode!=null and equipTypeCode!=''">
            and EQUIP_TYPE_CODE=#{equipTypeCode}
        </if>
        ORDER BY EQUIP_NAME ASC
    </select>

    <select id="getEquipmentDetail" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        SELECT
        t1.REC_ID	as "recId",  <!-- 记录编号 -->
        t1.COMPANY_CODE	as "companyCode",  <!-- 公司代码 -->
        t1.COMPANY_NAME	as "companyName",  <!-- 公司名称 -->
        t1.DEPT_CODE	as "deptCode",  <!-- 部门代码 -->
        t1.DEPT_NAME	as "deptName",  <!-- 部门名称 -->
        t1.EQUIP_CODE	as "equipCode",  <!-- 设备编码 -->
        t1.EQUIP_NAME	as "equipName",  <!-- 设备名称 -->
        t1.MAJOR_CODE	as "majorCode",  <!-- 专业代码 -->
        t1.MAJOR_NAME	as "majorName",  <!-- 专业名称 -->
        t1.SYSTEM_CODE	as "systemCode",  <!-- 系统代码 -->
        t1.SYSTEM_NAME	as "systemName",  <!-- 系统名称 -->
        t1.EQUIP_TYPE_CODE	as "equipTypeCode",  <!-- 设备分类代码 -->
        t1.EQUIP_TYPE_NAME	as "equipTypeName",  <!-- 设备分类名称 -->
        t1.SPECIAL_EQUIP_FLAG	as "specialEquipFlag",  <!-- 特种设备标识 -->
        t1.OTHER_EQUIP_FLAG	as "otherEquipFlag",  <!-- 其他设备标识 -->
        t1.SOURCE_KIND	as "sourceKind",  <!-- 设备来源 -->
        t1.BOM_TYPE	as "bomType",  <!-- BOM类型 -->
        t1.MANUFACTURE	as "manufacture",  <!-- 生产厂家 -->
        t1.ORDER_NO	as "orderNo",  <!-- 合同号 -->
        t1.ORDER_NAME	as "orderName",  <!-- 合同名称 -->
        t1.MAT_SPECIFI	as "matSpecifi",  <!-- 型号规格 -->
        t1.BRAND	as "brand",  <!-- 品牌 -->
        t1.MANUFACTURE_DATE	as "manufactureDate",  <!-- 出厂日期 -->
        t1.MANUFACTURE_NO	as "manufactureNo",  <!-- 出厂编号 -->
        t1.START_USE_DATE	as "startUseDate",  <!-- 开始使用日期 -->
        t1.END_USE_TIME	as "endUseTime",  <!-- 停止使用日期 -->
        t1.OTHER_FEATURE	as "otherFeature",  <!-- 其它特征参数 -->
        t1.MEASURE_UNIT	as "measureUnit",  <!-- 计量单位 -->
        t1.QUANTITY	as "quantity",  <!-- 数量 -->
        t1.IN_ACCOUNT_TIME	as "inAccountTime",  <!-- 进设备台帐时间 -->
        t1.PICK_NO	as "pickNo",  <!-- 领用人工号 -->
        t1.PICK_NAME	as "pickName",  <!-- 领用人姓名 -->
        t1.EQUIP_STATUS	as "equipStatus",  <!-- 设备状态 -->
        t1.SOURCE_APP_NO	as "sourceAppNo",  <!-- 来源单号 -->
        t1.SOURCE_SUB_NO	as "sourceSubNo",  <!-- 来源明细号 -->
        t1.SOURCE_REC_ID	as "sourceRecId",  <!-- 来源记录编号 -->
        t1.INSTALL_DEALER	as "installDealer",  <!-- 安装单位 -->
        t1.DOC_ID	as "docId",  <!-- 附件编号 -->
        t1.ORIGIN_LINE_NO	as "originLineNo",  <!-- 来源线别代码 -->
        t1.ORIGIN_LINE_NAME	as "originLineName",  <!-- 来源线别名称 -->
        t1.ORIGIN_SEG_NO	as "originSegNo",  <!-- 来源线段代码 -->
        t1.ORIGIN_SEG_NAME	as "originSegName",  <!-- 来源线段名称 -->
        t1.USE_LINE_NO	as "useLineNo",  <!-- 应用线别代码 -->
        t1.USE_LINE_NAME	as "useLineName",  <!-- 应用线别 -->
        t1.USE_SEG_NO	as "useSegNo",  <!-- 应用线段代码 -->
        t1.USE_SEG_NAME	as "useSegName",  <!-- 应用线段 -->
        t1.POSITION1_CODE	as "position1Code",  <!-- 位置一 -->
        t1.POSITION1_NAME	as "position1Name",  <!-- 位置一名称 -->
        t1.POSITION2_CODE	as "position2Code",  <!-- 位置二 -->
        t1.POSITION2_NAME	as "position2Name",  <!-- 位置二名称 -->
        t1.POSITION3	as "position3",  <!-- 位置三 -->
        t1.POSITION_REMARK	as "positionRemark",  <!-- 位置补充说明 -->
        t1.TOTAL_MILES	as "totalMiles",  <!-- 走行里程 -->
        t1.REMARK	as "remark",  <!-- 备注 -->
        t1.APPROVAL_STATUS	as "approvalStatus",  <!-- 审批状态 -->
        t1.WORK_FLOW_INST_ID	as "workFlowInstId",  <!-- 工作流实例ID -->
        t1.WORK_FLOW_INST_STATUS	as "workFlowInstStatus",  <!-- 工作流实例状态 -->
        t1.VERIFY_DATE	as "verifyDate",  <!-- 特种设备检测日期 -->
        t1.VERIFY_VALIDITY_DATE	as "verifyValidityDate",  <!-- 特种设备检测有效期 -->
        t2.NAME	as "recCreator",  <!-- 创建者 -->
        t1.REC_CREATE_TIME	as "recCreateTime",  <!-- 创建时间 -->
        t3.NAME	as "recRevisor",  <!-- 修改者 -->
        t1.REC_REVISE_TIME	as "recReviseTime",  <!-- 修改时间 -->
        t1.REC_DELETOR	as "recDeletor",  <!-- 删除者 -->
        t1.REC_DELETE_TIME	as "recDeleteTime",  <!-- 删除时间 -->
        t1.DELETE_FLAG	as "deleteFlag",  <!-- 删除标志 -->
        t1.ARCHIVE_FLAG	as "archiveFlag",  <!-- 归档标记 -->
        t1.REC_STATUS	as "recStatus",  <!-- 记录状态 -->
        t1.EXT1	as "ext1",  <!-- 扩展字段1 -->
        t1.EXT2	as "ext2",  <!-- 扩展字段2 -->
        t1.EXT3	as "ext3",  <!-- 扩展字段3 -->
        t1.EXT4	as "ext4",  <!-- 扩展字段4 -->
        t1.EXT5	as "ext5" <!-- 扩展字段5 -->
        FROM T_EQUIPMENT t1
        LEFT JOIN SYS_USER t2 on t1.REC_CREATOR=t2.LOGIN_NAME
        LEFT JOIN SYS_USER t3 on t1.REC_CREATOR=t3.LOGIN_NAME
        WHERE REC_ID=#{id}
    </select>

    <select id="getEquipmentDetailByCode" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        <include refid="equip-cols"/>
        FROM T_EQUIPMENT WHERE EQUIP_CODE=#{code} AND DELETE_FLAG='0'
    </select>

    <select id="getMaxCode" resultType="java.lang.String">
        SELECT max(EQUIP_CODE)
        FROM T_EQUIPMENT
    </select>

    <insert id="addEquipment">
        INSERT INTO T_EQUIPMENT (
        REC_ID,
        <if test="companyCode!=null and companyCode!=''">
            COMPANY_CODE,
        </if>
        <if test="companyName!=null and companyName!=''">
            COMPANY_NAME,
        </if>
        <if test="deptCode!=null and deptCode!=''">
            DEPT_CODE,
        </if>
        <if test="deptName!=null and deptName!=''">
            DEPT_NAME,
        </if>
        <if test="equipCode!=null and equipCode!=''">
            EQUIP_CODE,
        </if>
        <if test="equipName!=null and equipName!=''">
            EQUIP_NAME,
        </if>
        <if test="majorCode!=null and majorCode!=''">
            MAJOR_CODE,
        </if>
        <if test="majorName!=null and majorName!=''">
            MAJOR_NAME,
        </if>
        <if test="systemCode!=null and systemCode!=''">
            SYSTEM_CODE,
        </if>
        <if test="systemName!=null and systemName!=''">
            SYSTEM_NAME,
        </if>
        <if test="equipTypeCode!=null and equipTypeCode!=''">
            EQUIP_TYPE_CODE,
        </if>
        <if test="equipTypeName!=null and equipTypeName!=''">
            EQUIP_TYPE_NAME,
        </if>
        <if test="specialEquipFlag!=null and specialEquipFlag!=''">
            SPECIAL_EQUIP_FLAG,
        </if>
        <if test="otherEquipFlag!=null and otherEquipFlag!=''">
            OTHER_EQUIP_FLAG,
        </if>
        <if test="sourceKind!=null and sourceKind!=''">
            SOURCE_KIND,
        </if>
        <if test="bomType!=null and bomType!=''">
            BOM_TYPE,
        </if>
        <if test="manufacture!=null and manufacture!=''">
            MANUFACTURE,
        </if>
        <if test="orderNo!=null and orderNo!=''">
            ORDER_NO,
        </if>
        <if test="orderName!=null and orderName!=''">
            ORDER_NAME,
        </if>
        <if test="matSpecifi!=null and matSpecifi!=''">
            MAT_SPECIFI,
        </if>
        <if test="brand!=null and brand!=''">
            BRAND,
        </if>
        <if test="manufactureDate!=null and manufactureDate!=''">
            MANUFACTURE_DATE,
        </if>
        <if test="manufactureNo!=null and manufactureNo!=''">
            MANUFACTURE_NO,
        </if>
        <if test="startUseDate!=null and startUseDate!=''">
            START_USE_DATE,
        </if>
        <if test="quantity!=null">
            QUANTITY,
        </if>
        <if test="inAccountTime!=null and inAccountTime!=''">
            IN_ACCOUNT_TIME,
        </if>
        <if test="pickNo!=null and pickNo!=''">
            PICK_NO,
        </if>
        <if test="pickName!=null and pickName!=''">
            PICK_NAME,
        </if>
        <if test="equipStatus!=null and equipStatus!=''">
            EQUIP_STATUS,
        </if>
        <if test="sourceAppNo!=null and sourceAppNo!=''">
            SOURCE_APP_NO,
        </if>
        <if test="sourceSubNo!=null and sourceSubNo!=''">
            SOURCE_SUB_NO,
        </if>
        <if test="sourceRecId!=null and sourceRecId!=''">
            SOURCE_REC_ID,
        </if>
        <if test="installDealer!=null and installDealer!=''">
            INSTALL_DEALER,
        </if>
        <if test="docId!=null and docId!=''">
            DOC_ID,
        </if>
        <if test="originLineNo!=null and originLineNo!=''">
            ORIGIN_LINE_NO,
        </if>
        <if test="originLineName!=null and originLineName!=''">
            ORIGIN_LINE_NAME,
        </if>
        <if test="originSegNo!=null and originSegNo!=''">
            ORIGIN_SEG_NO,
        </if>
        <if test="originSegName!=null and originSegName!=''">
            ORIGIN_SEG_NAME,
        </if>
        <if test="useLineNo!=null and useLineNo!=''">
            USE_LINE_NO,
        </if>
        <if test="useLineName!=null and useLineName!=''">
            USE_LINE_NAME,
        </if>
        <if test="useSegNo!=null and useSegNo!=''">
            USE_SEG_NO,
        </if>
        <if test="useSegName!=null and useSegName!=''">
            USE_SEG_NAME,
        </if>
        <if test="position1Code!=null and position1Code!=''">
            POSITION1_CODE,
        </if>
        <if test="position1Name!=null and position1Name!=''">
            POSITION1_NAME,
        </if>
        <if test="position2Code!=null and position2Code!=''">
            POSITION2_CODE,
        </if>
        <if test="position2Name!=null and position2Name!=''">
            POSITION2_NAME,
        </if>
        <if test="position3!=null and position3!=''">
            POSITION3,
        </if>
        <if test="positionRemark!=null and positionRemark!=''">
            POSITION_REMARK,
        </if>
        <if test="totalMiles!=null and totalMiles!=''">
            TOTAL_MILES,
        </if>
        <if test="remark!=null and remark!=''">
            REMARK,
        </if>
        <if test="approvalStatus!=null and approvalStatus!=''">
            APPROVAL_STATUS,
        </if>
        REC_CREATOR, REC_CREATE_TIME, DELETE_FLAG)
        VALUES (
        SYS_GUID(),
        <if test="companyCode!=null and companyCode!=''">
            #{companyCode},
        </if>
        <if test="companyName!=null and companyName!=''">
            #{companyName},
        </if>
        <if test="deptCode!=null and deptCode!=''">
            #{deptCode},
        </if>
        <if test="deptName!=null and deptName!=''">
            #{deptName},
        </if>
        <if test="equipCode!=null and equipCode!=''">
            #{equipCode},
        </if>
        <if test="equipName!=null and equipName!=''">
            #{equipName},
        </if>
        <if test="majorCode!=null and majorCode!=''">
            #{majorCode},
        </if>
        <if test="majorName!=null and majorName!=''">
            #{majorName},
        </if>
        <if test="systemCode!=null and systemCode!=''">
            #{systemCode},
        </if>
        <if test="systemName!=null and systemName!=''">
            #{systemName},
        </if>
        <if test="equipTypeCode!=null and equipTypeCode!=''">
            #{equipTypeCode},
        </if>
        <if test="equipTypeName!=null and equipTypeName!=''">
            #{equipTypeName},
        </if>
        <if test="specialEquipFlag!=null and specialEquipFlag!=''">
            #{specialEquipFlag},
        </if>
        <if test="sourceKind!=null and sourceKind!=''">
            #{sourceKind},
        </if>
        <if test="bomType!=null and bomType!=''">
            #{bomType},
        </if>
        <if test="manufacture!=null and manufacture!=''">
            #{manufacture},
        </if>
        <if test="orderNo!=null and orderNo!=''">
            #{orderNo},
        </if>
        <if test="orderName!=null and orderName!=''">
            #{orderName},
        </if>
        <if test="matSpecifi!=null and matSpecifi!=''">
            #{matSpecifi},
        </if>
        <if test="brand!=null and brand!=''">
            #{brand},
        </if>
        <if test="manufactureDate!=null and manufactureDate!=''">
            #{manufactureDate},
        </if>
        <if test="manufactureNo!=null and manufactureNo!=''">
            #{manufactureNo},
        </if>
        <if test="startUseDate!=null and startUseDate!=''">
            #{startUseDate},
        </if>
        <if test="quantity!=null">
            #{quantity},
        </if>
        <if test="inAccountTime!=null and inAccountTime!=''">
            #{inAccountTime},
        </if>
        <if test="pickNo!=null and pickNo!=''">
            #{pickNo},
        </if>
        <if test="pickName!=null and pickName!=''">
            #{pickName},
        </if>
        <if test="equipStatus!=null and equipStatus!=''">
            #{equipStatus},
        </if>
        <if test="sourceAppNo!=null and sourceAppNo!=''">
            #{sourceAppNo},
        </if>
        <if test="sourceSubNo!=null and sourceSubNo!=''">
            #{sourceSubNo},
        </if>
        <if test="sourceRecId!=null and sourceRecId!=''">
            #{sourceRecId},
        </if>
        <if test="installDealer!=null and installDealer!=''">
            #{installDealer},
        </if>
        <if test="docId!=null and docId!=''">
            #{docId},
        </if>
        <if test="originLineNo!=null and originLineNo!=''">
            #{originLineNo},
        </if>
        <if test="originLineName!=null and originLineName!=''">
            #{originLineName},
        </if>
        <if test="originSegNo!=null and originSegNo!=''">
            #{originSegNo},
        </if>
        <if test="originSegName!=null and originSegName!=''">
            #{originSegName},
        </if>
        <if test="useLineNo!=null and useLineNo!=''">
            #{useLineNo},
        </if>
        <if test="useLineName!=null and useLineName!=''">
            #{useLineName},
        </if>
        <if test="useSegNo!=null and useSegNo!=''">
            #{useSegNo},
        </if>
        <if test="useSegName!=null and useSegName!=''">
            #{useSegName},
        </if>
        <if test="position1Code!=null and position1Code!=''">
            #{position1Code},
        </if>
        <if test="position1Name!=null and position1Name!=''">
            #{position1Name},
        </if>
        <if test="position2Code!=null and position2Code!=''">
            #{position2Code},
        </if>
        <if test="position2Name!=null and position2Name!=''">
            #{position2Name},
        </if>
        <if test="position3!=null and position3!=''">
            #{position3},
        </if>
        <if test="positionRemark!=null and positionRemark!=''">
            #{positionRemark},
        </if>
        <if test="totalMiles!=null and totalMiles!=''">
            #{totalMiles},
        </if>
        <if test="remark!=null and remark!=''">
            #{remark},
        </if>
        <if test="approvalStatus!=null and approvalStatus!=''">
            #{approvalStatus},
        </if>
        #{recCreator}, #{recCreateTime}, '0')
    </insert>

    <update id="modifyEquipment">
        UPDATE T_EQUIPMENT SET
        <if test="companyCode!=null">
            COMPANY_CODE=#{companyCode},
        </if>
        <if test="companyName!=null">
            COMPANY_NAME=#{companyName},
        </if>
        <if test="deptCode!=null">
            DEPT_CODE=#{deptCode},
        </if>
        <if test="deptName!=null">
            DEPT_NAME=#{deptName},
        </if>
        <if test="equipName!=null">
            EQUIP_NAME=#{equipName},
        </if>
        <if test="majorCode!=null">
            MAJOR_CODE=#{majorCode},
        </if>
        <if test="majorName!=null">
            MAJOR_NAME=#{majorName},
        </if>
        <if test="systemCode!=null">
            SYSTEM_CODE=#{systemCode},
        </if>
        <if test="systemName!=null">
            SYSTEM_NAME=#{systemName},
        </if>
        <if test="equipTypeCode!=null">
            EQUIP_TYPE_CODE=#{equipTypeCode},
        </if>
        <if test="equipTypeName!=null">
            EQUIP_TYPE_NAME=#{equipTypeName},
        </if>
        <if test="specialEquipFlag!=null">
            SPECIAL_EQUIP_FLAG=#{specialEquipFlag},
        </if>
        <if test="otherEquipFlag!=null">
            OTHER_EQUIP_FLAG=#{otherEquipFlag},
        </if>
        <if test="sourceKind!=null">
            SOURCE_KIND=#{sourceKind},
        </if>
        <if test="bomType!=null">
            BOM_TYPE=#{bomType},
        </if>
        <if test="manufacture!=null">
            MANUFACTURE=#{manufacture},
        </if>
        <if test="orderNo!=null">
            ORDER_NO=#{orderNo},
        </if>
        <if test="orderName!=null">
            ORDER_NAME=#{orderName},
        </if>
        <if test="matSpecifi!=null">
            MAT_SPECIFI=#{matSpecifi},
        </if>
        <if test="brand!=null">
            BRAND=#{brand},
        </if>
        <if test="manufactureDate!=null">
            MANUFACTURE_DATE=#{manufactureDate},
        </if>
        <if test="manufactureNo!=null">
            MANUFACTURE_NO=#{manufactureNo},
        </if>
        <if test="startUseDate!=null">
            START_USE_DATE=#{startUseDate},
        </if>
        <if test="quantity!=null">
            QUANTITY=#{quantity},
        </if>
        <if test="pickNo!=null">
            PICK_NO=#{pickNo},
        </if>
        <if test="pickName!=null">
            PICK_NAME=#{pickName},
        </if>
        <if test="equipStatus!=null">
            EQUIP_STATUS=#{equipStatus},
        </if>
        <if test="sourceAppNo!=null">
            SOURCE_APP_NO=#{sourceAppNo},
        </if>
        <if test="sourceSubNo!=null">
            SOURCE_SUB_NO=#{sourceSubNo},
        </if>
        <if test="sourceRecId!=null">
            SOURCE_REC_ID=#{sourceRecId},
        </if>
        <if test="installDealer!=null">
            INSTALL_DEALER=#{installDealer},
        </if>
        <if test="docId!=null">
            DOC_ID=#{docId},
        </if>
        <if test="originLineNo!=null">
            ORIGIN_LINE_NO=#{originLineNo},
        </if>
        <if test="originLineName!=null">
            ORIGIN_LINE_NAME=#{originLineName},
        </if>
        <if test="originSegNo!=null">
            ORIGIN_SEG_NO=#{originSegNo},
        </if>
        <if test="originSegName!=null">
            ORIGIN_SEG_NAME=#{originSegName},
        </if>
        <if test="useLineNo!=null">
            USE_LINE_NO=#{useLineNo},
        </if>
        <if test="useLineName!=null">
            USE_LINE_NAME=#{useLineName},
        </if>
        <if test="useSegNo!=null">
            USE_SEG_NO=#{useSegNo},
        </if>
        <if test="useSegName!=null">
            USE_SEG_NAME=#{useSegName},
        </if>
        <if test="position1Code!=null">
            POSITION1_CODE=#{position1Code},
        </if>
        <if test="position1Name!=null">
            POSITION1_NAME=#{position1Name},
        </if>
        <if test="position2Code!=null">
            POSITION2_CODE=#{position2Code},
        </if>
        <if test="position2Name!=null">
            POSITION2_NAME=#{position2Name},
        </if>
        <if test="position3!=null">
            POSITION3=#{position3},
        </if>
        <if test="positionRemark!=null">
            POSITION_REMARK=#{positionRemark},
        </if>
        <if test="remark!=null">
            REMARK=#{remark},
        </if>
        REC_REVISOR=#{recRevisor}, REC_REVISE_TIME=#{recReviseTime}
        WHERE REC_ID=#{recId} AND DELETE_FLAG='0'
    </update>

    <update id="deleteEquipment">
        UPDATE T_EQUIPMENT SET
        DELETE_FLAG='1', REC_DELETOR=#{userId}, REC_DELETE_TIME=#{time}
        WHERE REC_ID IN (
        <foreach collection="ids" index="index" item="id" separator=",">
            #{id}
        </foreach>
        )
    </update>

    <insert id="importEquipment" parameterType="com.wzmtr.eam.dto.req.equipment.EquipmentReqDTO">
        INSERT ALL
        <foreach collection="list" index="index" item="equipment" separator=" ">
            INTO T_EQUIPMENT
            (REC_ID,  <!-- 记录编号 -->
            COMPANY_CODE,  <!-- 公司代码 -->
            COMPANY_NAME,  <!-- 公司名称 -->
            DEPT_CODE,<!-- 部门编码 -->
            DEPT_NAME,<!-- 部门名称 -->
            EQUIP_CODE,  <!-- 设备编码 -->
            EQUIP_NAME,  <!-- 设备名称 -->
            MAJOR_CODE,  <!-- 专业代码 -->
            MAJOR_NAME,  <!-- 专业名称 -->
            SYSTEM_CODE,  <!-- 系统代码 -->
            SYSTEM_NAME,  <!-- 系统名称 -->
            EQUIP_TYPE_CODE,  <!-- 设备分类代码 -->
            EQUIP_TYPE_NAME,  <!-- 设备分类名称 -->
            SPECIAL_EQUIP_FLAG,  <!-- 特种设备标识 -->
            OTHER_EQUIP_FLAG,  <!-- 其他设备标识 -->
            SOURCE_KIND,  <!-- 设备来源 -->
            MANUFACTURE,  <!-- 生产厂家 -->
            MAT_SPECIFI,  <!-- 型号规格 -->
            BRAND,  <!-- 品牌 -->
            MANUFACTURE_DATE,  <!-- 出厂日期 -->
            MANUFACTURE_NO,  <!-- 出厂编号 -->
            START_USE_DATE,  <!-- 开始使用日期 -->
            QUANTITY,  <!-- 数量 -->
            IN_ACCOUNT_TIME,  <!-- 进设备台帐时间 -->
            EQUIP_STATUS,  <!-- 设备状态 -->
            SOURCE_APP_NO,  <!-- 来源单号 -->
            SOURCE_SUB_NO,  <!-- 来源明细号 -->
            SOURCE_REC_ID,  <!-- 来源记录编号 -->
            INSTALL_DEALER,  <!-- 安装单位 -->
            DOC_ID,  <!-- 附件编号 -->
            ORIGIN_LINE_NO,  <!-- 来源线别代码 -->
            ORIGIN_LINE_NAME,  <!-- 来源线别名称 -->
            ORIGIN_SEG_NO,  <!-- 来源线段代码 -->
            ORIGIN_SEG_NAME,  <!-- 来源线段名称 -->
            USE_LINE_NO,  <!-- 应用线别代码 -->
            USE_LINE_NAME,  <!-- 应用线别 -->
            USE_SEG_NO,  <!-- 应用线段代码 -->
            USE_SEG_NAME,  <!-- 应用线段 -->
            POSITION1_CODE,  <!-- 位置一 -->
            POSITION1_NAME,  <!-- 位置一名称 -->
            POSITION2_CODE,  <!-- 位置二 -->
            POSITION2_NAME,  <!-- 位置二名称 -->
            POSITION3,  <!-- 位置三 -->
            POSITION_REMARK,  <!-- 位置补充说明 -->
            TOTAL_MILES,  <!-- 走行里程 -->
            REMARK,  <!-- 备注 -->
            APPROVAL_STATUS,  <!-- 审批状态 -->
            VERIFY_DATE,  <!-- 特种设备检测日期 -->
            VERIFY_VALIDITY_DATE,  <!-- 特种设备检测有效期 -->
            REC_CREATOR,  <!-- 创建者 -->
            REC_CREATE_TIME,  <!-- 创建时间 -->
            REC_REVISOR,  <!-- 修改者 -->
            REC_REVISE_TIME,  <!-- 修改时间 -->
            REC_DELETOR,  <!-- 删除者 -->
            REC_DELETE_TIME,  <!-- 删除时间 -->
            DELETE_FLAG,  <!-- 删除标志 -->
            ARCHIVE_FLAG,  <!-- 归档标记 -->
            REC_STATUS  <!-- 记录状态 -->)
            VALUES
            (SYS_GUID(),
            #{equipment.companyCode},
            #{equipment.companyName},
            #{equipment.deptCode},
            #{equipment.deptName},
            #{equipment.equipCode},
            #{equipment.equipName},
            (SELECT NODE_CODE FROM T_EQUIPMENT_CATEGORY where NODE_NAME=#{equipment.majorName} and NODE_LEVEL=1),
            #{equipment.majorName},
            (SELECT NODE_CODE FROM T_EQUIPMENT_CATEGORY where NODE_NAME=#{equipment.systemName} and NODE_LEVEL=2),
            #{equipment.systemName},
            (SELECT NODE_CODE FROM T_EQUIPMENT_CATEGORY where NODE_NAME=#{equipment.equipTypeName} and NODE_LEVEL=3),
            #{equipment.equipTypeName},
            #{equipment.specialEquipFlag},
            #{equipment.otherEquipFlag},
            ' ',
            #{equipment.manufacture},
            #{equipment.matSpecifi},
            #{equipment.brand},
            #{equipment.manufactureDate,jdbcType=VARCHAR},
            #{equipment.manufactureNo,jdbcType=VARCHAR},
            #{equipment.startUseDate,jdbcType=VARCHAR},
            #{equipment.quantity,jdbcType=NUMERIC},
            ' ',
            ' ',
            ' ',
            ' ',
            ' ',
            #{equipment.installDealer,jdbcType=VARCHAR},
            ' ',
            ' ',
            ' ',
            ' ',
            ' ',
            #{equipment.useLineNo,jdbcType=VARCHAR},
            #{equipment.useLineName,jdbcType=VARCHAR},
            #{equipment.useSegNo,jdbcType=VARCHAR},
            #{equipment.useSegName,jdbcType=VARCHAR},
            (SELECT NODE_CODE FROM SYS_REGION where NODE_NAME=#{equipment.position1Name,jdbcType=VARCHAR} and LINE_CODE=#{equipment.useLineNo,jdbcType=VARCHAR}),
            #{equipment.position1Name,jdbcType=VARCHAR},
            (SELECT NODE_CODE FROM SYS_REGION where NODE_NAME=#{equipment.position2Name,jdbcType=VARCHAR} and LINE_CODE=#{equipment.useLineNo,jdbcType=VARCHAR}),
            #{equipment.position2Name,jdbcType=VARCHAR},
            #{equipment.position3,jdbcType=VARCHAR},
            #{equipment.positionRemark,jdbcType=VARCHAR},
            0,
            #{equipment.remark,jdbcType=VARCHAR},
            #{equipment.approvalStatus,jdbcType=VARCHAR},
            ' ',
            ' ',
            #{equipment.recCreator},
            #{equipment.recCreateTime},
            ' ',
            ' ',
            ' ',
            ' ',
            '0',
            ' ',
            ' ')
        </foreach>
        SELECT * FROM dual
    </insert>

    <insert id="insertEquipment" parameterType="com.wzmtr.eam.dto.req.equipment.EquipmentReqDTO">
        INSERT INTO T_EQUIPMENT
        (REC_ID,  <!-- 记录编号 -->
        COMPANY_CODE,  <!-- 公司代码 -->
        COMPANY_NAME,  <!-- 公司名称 -->
        DEPT_CODE,<!-- 部门编码 -->
        DEPT_NAME,<!-- 部门名称 -->
        EQUIP_CODE,  <!-- 设备编码 -->
        EQUIP_NAME,  <!-- 设备名称 -->
        MAJOR_CODE,  <!-- 专业代码 -->
        MAJOR_NAME,  <!-- 专业名称 -->
        SYSTEM_CODE,  <!-- 系统代码 -->
        SYSTEM_NAME,  <!-- 系统名称 -->
        EQUIP_TYPE_CODE,  <!-- 设备分类代码 -->
        EQUIP_TYPE_NAME,  <!-- 设备分类名称 -->
        SPECIAL_EQUIP_FLAG,  <!-- 特种设备标识 -->
        OTHER_EQUIP_FLAG,  <!-- 其他设备标识 -->
        SOURCE_KIND,  <!-- 设备来源 -->
        BOM_TYPE,  <!-- BOM类型 -->
        MANUFACTURE,  <!-- 生产厂家 -->
        ORDER_NO,  <!-- 合同号 -->
        ORDER_NAME,  <!-- 合同名称 -->
        MAT_SPECIFI,  <!-- 型号规格 -->
        BRAND,  <!-- 品牌 -->
        MANUFACTURE_DATE,  <!-- 出厂日期 -->
        MANUFACTURE_NO,  <!-- 出厂编号 -->
        START_USE_DATE,  <!-- 开始使用日期 -->
        END_USE_TIME,  <!-- 停止使用日期 -->
        OTHER_FEATURE,  <!-- 其它特征参数 -->
        MEASURE_UNIT,  <!-- 计量单位 -->
        QUANTITY,  <!-- 数量 -->
        IN_ACCOUNT_TIME,  <!-- 进设备台帐时间 -->
        PICK_NO,  <!-- 领用人工号 -->
        PICK_NAME,  <!-- 领用人姓名 -->
        EQUIP_STATUS,  <!-- 设备状态 -->
        SOURCE_APP_NO,  <!-- 来源单号 -->
        SOURCE_SUB_NO,  <!-- 来源明细号 -->
        SOURCE_REC_ID,  <!-- 来源记录编号 -->
        INSTALL_DEALER,  <!-- 安装单位 -->
        DOC_ID,  <!-- 附件编号 -->
        ORIGIN_LINE_NO,  <!-- 来源线别代码 -->
        ORIGIN_LINE_NAME,  <!-- 来源线别名称 -->
        ORIGIN_SEG_NO,  <!-- 来源线段代码 -->
        ORIGIN_SEG_NAME,  <!-- 来源线段名称 -->
        USE_LINE_NO,  <!-- 应用线别代码 -->
        USE_LINE_NAME,  <!-- 应用线别 -->
        USE_SEG_NO,  <!-- 应用线段代码 -->
        USE_SEG_NAME,  <!-- 应用线段 -->
        POSITION1_CODE,  <!-- 位置一 -->
        POSITION1_NAME,  <!-- 位置一名称 -->
        POSITION2_CODE,  <!-- 位置二 -->
        POSITION2_NAME,  <!-- 位置二名称 -->
        POSITION3,  <!-- 位置三 -->
        POSITION_REMARK,  <!-- 位置补充说明 -->
        TOTAL_MILES,  <!-- 走行里程 -->
        REMARK,  <!-- 备注 -->
        APPROVAL_STATUS,  <!-- 审批状态 -->
        WORK_FLOW_INST_ID,  <!-- 工作流实例ID -->
        WORK_FLOW_INST_STATUS,  <!-- 工作流实例状态 -->
        VERIFY_DATE,  <!-- 特种设备检测日期 -->
        VERIFY_VALIDITY_DATE,  <!-- 特种设备检测有效期 -->
        REC_CREATOR,  <!-- 创建者 -->
        REC_CREATE_TIME,  <!-- 创建时间 -->
        REC_REVISOR,  <!-- 修改者 -->
        REC_REVISE_TIME,  <!-- 修改时间 -->
        REC_DELETOR,  <!-- 删除者 -->
        REC_DELETE_TIME,  <!-- 删除时间 -->
        DELETE_FLAG,  <!-- 删除标志 -->
        ARCHIVE_FLAG,  <!-- 归档标记 -->
        REC_STATUS,  <!-- 记录状态 -->
        EXT1,  <!-- 扩展字段1 -->
        EXT2,  <!-- 扩展字段2 -->
        EXT3,  <!-- 扩展字段3 -->
        EXT4,  <!-- 扩展字段4 -->
        EXT5  <!-- 扩展字段5 -->)
        VALUES
        (#{recId,jdbcType=VARCHAR},
        #{companyCode,jdbcType=VARCHAR},
        #{companyName,jdbcType=VARCHAR},
        #{deptCode,jdbcType=VARCHAR},
        #{deptName,jdbcType=VARCHAR},
        #{equipCode,jdbcType=VARCHAR},
        #{equipName,jdbcType=VARCHAR},
        #{majorCode,jdbcType=VARCHAR},
        #{majorName,jdbcType=VARCHAR},
        #{systemCode,jdbcType=VARCHAR},
        #{systemName,jdbcType=VARCHAR},
        #{equipTypeCode,jdbcType=VARCHAR},
        #{equipTypeName,jdbcType=VARCHAR},
        #{specialEquipFlag,jdbcType=VARCHAR},
        #{otherEquipFlag,jdbcType=VARCHAR},
        #{sourceKind,jdbcType=VARCHAR},
        #{bomType,jdbcType=VARCHAR},
        #{manufacture,jdbcType=VARCHAR},
        #{orderNo,jdbcType=VARCHAR},
        #{orderName,jdbcType=VARCHAR},
        #{matSpecifi,jdbcType=VARCHAR},
        #{brand,jdbcType=VARCHAR},
        #{manufactureDate,jdbcType=VARCHAR},
        #{manufactureNo,jdbcType=VARCHAR},
        #{startUseDate,jdbcType=VARCHAR},
        #{endUseTime,jdbcType=VARCHAR},
        #{otherFeature,jdbcType=VARCHAR},
        #{measureUnit,jdbcType=VARCHAR},
        #{quantity,jdbcType=NUMERIC},
        #{inAccountTime,jdbcType=VARCHAR},
        #{pickNo,jdbcType=VARCHAR},
        #{pickName,jdbcType=VARCHAR},
        #{equipStatus,jdbcType=VARCHAR},
        #{sourceAppNo,jdbcType=VARCHAR},
        #{sourceSubNo,jdbcType=VARCHAR},
        #{sourceRecId,jdbcType=VARCHAR},
        #{installDealer,jdbcType=VARCHAR},
        #{docId,jdbcType=VARCHAR},
        #{originLineNo,jdbcType=VARCHAR},
        #{originLineName,jdbcType=VARCHAR},
        #{originSegNo,jdbcType=VARCHAR},
        #{originSegName,jdbcType=VARCHAR},
        #{useLineNo,jdbcType=VARCHAR},
        #{useLineName,jdbcType=VARCHAR},
        #{useSegNo,jdbcType=VARCHAR},
        #{useSegName,jdbcType=VARCHAR},
        #{position1Code,jdbcType=VARCHAR},
        #{position1Name,jdbcType=VARCHAR},
        #{position2Code,jdbcType=VARCHAR},
        #{position2Name,jdbcType=VARCHAR},
        #{position3,jdbcType=VARCHAR},
        #{positionRemark,jdbcType=VARCHAR},
        #{totalMiles,jdbcType=NUMERIC},
        #{remark,jdbcType=VARCHAR},
        #{approvalStatus,jdbcType=VARCHAR},
        #{workFlowInstId,jdbcType=VARCHAR},
        #{workFlowInstStatus,jdbcType=VARCHAR},
        #{verifyDate,jdbcType=VARCHAR},
        #{verifyValidityDate,jdbcType=VARCHAR},
        #{recCreator,jdbcType=VARCHAR},
        #{recCreateTime,jdbcType=VARCHAR},
        #{recRevisor,jdbcType=VARCHAR},
        #{recReviseTime,jdbcType=VARCHAR},
        #{recDeletor,jdbcType=VARCHAR},
        #{recDeleteTime,jdbcType=VARCHAR},
        '0',
        #{archiveFlag,jdbcType=VARCHAR},
        #{recStatus,jdbcType=VARCHAR},
        #{ext1,jdbcType=VARCHAR},
        #{ext2,jdbcType=VARCHAR},
        #{ext3,jdbcType=VARCHAR},
        #{ext4,jdbcType=VARCHAR},
        #{ext5,jdbcType=VARCHAR})
    </insert>

    <select id="listEquipment" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        <include refid="equip-cols"/>
        FROM T_EQUIPMENT WHERE
        REC_ID IN (
        <foreach collection="ids" index="index" item="id" separator=",">
            #{id}
        </foreach>
        ) AND DELETE_FLAG='0'
        ORDER BY EQUIP_NAME ASC
    </select>

    <select id="pageSiftEquipment" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        <include refid="equip-cols"/>
        FROM T_EQUIPMENT WHERE 1=1 AND DELETE_FLAG='0'
        <if test="req.bomType!=null and req.bomType!=''">
            and TRIM(BOM_TYPE) IS NOT NULL AND MAJOR_CODE ='07'
        </if>
        <if test="req.sourceRecId!=null and req.sourceRecId!=''">
            and SOURCE_REC_ID=#{req.sourceRecId}
        </if>
        <if test="req.approvalStatus!=null and req.approvalStatus!=''">
            and APPROVAL_STATUS=#{req.approvalStatus}
        </if>
        <if test="req.equipCode!=null and req.equipCode!=''">
            and EQUIP_CODE like '%' || #{req.equipCode} || '%'
        </if>
        <if test="req.equipName!=null and req.equipName!=''">
            and EQUIP_NAME like '%' || #{req.equipName} || '%'
        </if>
        <if test="req.useLineNo!=null and req.useLineNo!=''">
            and USE_LINE_NO=#{req.useLineNo}
        </if>
        <if test="req.useSegNo!=null and req.useSegNo!=''">
            and USE_SEG_NO=#{req.useSegNo}
        </if>
        <if test="req.position1Code!=null and req.position1Code!=''">
            and POSITION1_CODE=#{req.position1Code}
        </if>
        <if test="req.specialEquipFlag!=null and req.specialEquipFlag!=''">
            and SPECIAL_EQUIP_FLAG=#{req.specialEquipFlag}
        </if>
        <if test="req.otherEquipFlag!=null and req.otherEquipFlag!=''">
            and OTHER_EQUIP_FLAG=#{req.otherEquipFlag}
        </if>
        <if test="req.brand!=null and req.brand!=''">
            and BRAND=#{req.brand}
        </if>
        <if test="req.equipStatus!=null and req.equipStatus!=''">
            and EQUIP_STATUS=#{req.equipStatus}
        </if>
        <if test="req.manufacture!=null and req.manufacture!=''">
            and MANUFACTURE=#{req.manufacture}
        </if>
        <if test="req.startTime!=null and startTime!=''">
            and MANUFACTURE_DATE>=#{req.startTime}
        </if>
        <if test="req.endTime!=null and req.endTime!=''">
            and #{req.endTime}>=MANUFACTURE_DATE
        </if>
        <if test="req.majorCode!=null and req.majorCode!=''">
            and MAJOR_CODE=#{req.majorCode}
        </if>
        <if test="req.systemCode!=null and req.systemCode!=''">
            and SYSTEM_CODE=#{req.systemCode}
        </if>
        <if test="req.equipTypeCode!=null and req.equipTypeCode!=''">
            and EQUIP_TYPE_CODE=#{req.equipTypeCode}
        </if>
        <if test="req.subjectCode!=null and req.subjectCode!=''">
            and MAJOR_CODE=#{req.subjectCode}
        </if>
        <if test="req.lineNo!=null and req.lineNo!=''">
            and USE_LINE_NO=#{req.lineNo}
        </if>
        ORDER BY EQUIP_NAME ASC
    </select>

    <select id="siftEquipment" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        <include refid="equip-cols"/>
        FROM T_EQUIPMENT WHERE 1=1 AND DELETE_FLAG='0'
        <if test="bomType!=null and bomType!=''">
            and TRIM(BOM_TYPE) IS NOT NULL AND MAJOR_CODE ='07'
        </if>
        <if test="sourceRecId!=null and sourceRecId!=''">
            and SOURCE_REC_ID=#{sourceRecId}
        </if>
        <if test="approvalStatus!=null and approvalStatus!=''">
            and APPROVAL_STATUS=#{approvalStatus}
        </if>
        <if test="equipCode!=null and equipCode!=''">
            and EQUIP_CODE like '%' || #{equipCode} || '%'
        </if>
        <if test="equipName!=null and equipName!=''">
            and EQUIP_NAME like '%' || #{equipName} || '%'
        </if>
        <if test="useLineNo!=null and useLineNo!=''">
            and USE_LINE_NO=#{useLineNo}
        </if>
        <if test="useSegNo!=null and useSegNo!=''">
            and USE_SEG_NO=#{useSegNo}
        </if>
        <if test="position1Code!=null and position1Code!=''">
            and POSITION1_CODE=#{position1Code}
        </if>
        <if test="specialEquipFlag!=null and specialEquipFlag!=''">
            and SPECIAL_EQUIP_FLAG=#{specialEquipFlag}
        </if>
        <if test="otherEquipFlag!=null and otherEquipFlag!=''">
            and OTHER_EQUIP_FLAG=#{otherEquipFlag}
        </if>
        <if test="brand!=null and brand!=''">
            and BRAND=#{brand}
        </if>
        <if test="equipStatus!=null and equipStatus!=''">
            and EQUIP_STATUS=#{equipStatus}
        </if>
        <if test="manufacture!=null and manufacture!=''">
            and MANUFACTURE=#{manufacture}
        </if>
        <if test="startTime!=null and startTime!=''">
            and MANUFACTURE_DATE>=#{startTime}
        </if>
        <if test="endTime!=null and endTime!=''">
            and #{endTime}>=MANUFACTURE_DATE
        </if>
        <if test="majorCode!=null and majorCode!=''">
            and MAJOR_CODE=#{majorCode}
        </if>
        <if test="systemCode!=null and systemCode!=''">
            and SYSTEM_CODE=#{systemCode}
        </if>
        <if test="equipTypeCode!=null and equipTypeCode!=''">
            and EQUIP_TYPE_CODE=#{equipTypeCode}
        </if>
        <if test="subjectCode!=null and subjectCode!=''">
            and MAJOR_CODE=#{subjectCode}
        </if>
        <if test="lineNo!=null and lineNo!=''">
            and USE_LINE_NO=#{lineNo}
        </if>
        ORDER BY EQUIP_NAME ASC
    </select>

    <select id="getSplitTransferDetail" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        <include refid="equip-cols"/>
        FROM T_EQUIPMENT WHERE 1=1 AND REC_ID=#{id} AND DELETE_FLAG='0'
        ORDER BY EQUIP_NAME ASC
    </select>

    <select id="selectByEquipName" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        SELECT
        EQUIP_CODE as equipCode,
        EQUIP_NAME as equipName
        from T_EQUIPMENT where
        MAJOR_CODE='07'
        <if test="equipName!=null and equipName!=''">
            and EQUIP_NAME = #{equipName}
        </if>
        order by EQUIP_NAME ASC
    </select>


    <select id="queryMajor" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO" >
        select
            MAJOR_CODE as "majorCode",
            USE_LINE_NO as "useLineNo"
        from T_EQUIPMENT
        where EQUIP_NAME = #{equipName}
    </select>

    <update id="updateEquipment">
        UPDATE T_EQUIPMENT SET
        <if test="companyCode!=null">
            COMPANY_CODE=#{companyCode},   <!-- 公司代码 -->
        </if>
        <if test="companyName!=null">
            COMPANY_NAME=#{companyName},   <!-- 公司名称 -->
        </if>
        <if test="deptCode!=null">
            DEPT_CODE=#{deptCode},   <!-- 公司代码 -->
        </if>
        <if test="deptName!=null">
            DEPT_NAME=#{deptName},   <!-- 公司名称 -->
        </if>
        <if test="equipCode!=null">
            EQUIP_CODE=#{equipCode},   <!-- 设备编码 -->
        </if>
        <if test="equipName!=null">
            EQUIP_NAME=#{equipName},   <!-- 设备名称 -->
        </if>
        <if test="majorCode!=null">
            MAJOR_CODE=#{majorCode},   <!-- 专业代码 -->
        </if>
        <if test="majorName!=null">
            MAJOR_NAME=#{majorName},   <!-- 专业名称 -->
        </if>
        <if test="systemCode!=null">
            SYSTEM_CODE=#{systemCode},   <!-- 系统代码 -->
        </if>
        <if test="systemName!=null">
            SYSTEM_NAME=#{systemName},   <!-- 系统名称 -->
        </if>
        <if test="equipTypeCode!=null">
            EQUIP_TYPE_CODE=#{equipTypeCode},   <!-- 设备分类代码 -->
        </if>
        <if test="equipTypeName!=null">
            EQUIP_TYPE_NAME=#{equipTypeName},   <!-- 设备分类名称 -->
        </if>
        <if test="specialEquipFlag!=null">
            SPECIAL_EQUIP_FLAG=#{specialEquipFlag},   <!-- 特种设备标识 -->
        </if>
        <if test="otherEquipFlag!=null">
            OTHER_EQUIP_FLAG=#{otherEquipFlag},   <!-- 其他设备标识 -->
        </if>
        <if test="sourceKind!=null">
            SOURCE_KIND=#{sourceKind},   <!-- 设备来源 -->
        </if>
        <if test="bomType!=null">
            BOM_TYPE=#{bomType},   <!-- BOM类型 -->
        </if>
        <if test="manufacture!=null">
            MANUFACTURE=#{manufacture},   <!-- 生产厂家 -->
        </if>
        <if test="orderNo!=null">
            ORDER_NO=#{orderNo},   <!-- 合同号 -->
        </if>
        <if test="orderName!=null">
            ORDER_NAME=#{orderName},   <!-- 合同名称 -->
        </if>
        <if test="matSpecifi!=null">
            MAT_SPECIFI=#{matSpecifi},   <!-- 型号规格 -->
        </if>
        <if test="brand!=null">
            BRAND=#{brand},   <!-- 品牌 -->
        </if>
        <if test="manufactureDate!=null">
            MANUFACTURE_DATE=#{manufactureDate},   <!-- 出厂日期 -->
        </if>
        <if test="manufactureNo!=null">
            MANUFACTURE_NO=#{manufactureNo},   <!-- 出厂编号 -->
        </if>
        <if test="startUseDate!=null">
            START_USE_DATE=#{startUseDate},   <!-- 开始使用日期 -->
        </if>
        <if test="endUseTime!=null">
            END_USE_TIME=#{endUseTime},   <!-- 停止使用日期 -->
        </if>
        <if test="otherFeature!=null">
            OTHER_FEATURE=#{otherFeature},   <!-- 其它特征参数 -->
        </if>
        <if test="measureUnit!=null">
            MEASURE_UNIT=#{measureUnit},   <!-- 计量单位 -->
        </if>
        <if test="quantity!=null">
            QUANTITY=#{quantity,jdbcType=NUMERIC},   <!-- 数量 -->
        </if>
        <if test="inAccountTime!=null">
            IN_ACCOUNT_TIME=#{inAccountTime},   <!-- 进设备台帐时间 -->
        </if>
        <if test="pickNo!=null">
            PICK_NO=#{pickNo},   <!-- 领用人工号 -->
        </if>
        <if test="pickName!=null">
            PICK_NAME=#{pickName},   <!-- 领用人姓名 -->
        </if>
        <if test="equipStatus!=null">
            EQUIP_STATUS=#{equipStatus},   <!-- 设备状态 -->
        </if>
        <if test="sourceAppNo!=null">
            SOURCE_APP_NO=#{sourceAppNo},   <!-- 来源单号 -->
        </if>
        <if test="sourceSubNo!=null">
            SOURCE_SUB_NO=#{sourceSubNo},   <!-- 来源明细号 -->
        </if>
        <if test="sourceRecId!=null">
            SOURCE_REC_ID=#{sourceRecId},   <!-- 来源记录编号 -->
        </if>
        <if test="installDealer!=null">
            INSTALL_DEALER=#{installDealer},   <!-- 安装单位 -->
        </if>
        <if test="docId!=null">
            DOC_ID=#{docId},   <!-- 附件编号 -->
        </if>
        <if test="originLineNo!=null">
            ORIGIN_LINE_NO=#{originLineNo},   <!-- 来源线别代码 -->
        </if>
        <if test="originLineName!=null">
            ORIGIN_LINE_NAME=#{originLineName},   <!-- 来源线别名称 -->
        </if>
        <if test="originSegNo!=null">
            ORIGIN_SEG_NO=#{originSegNo},   <!-- 来源线段代码 -->
        </if>
        <if test="originSegName!=null">
            ORIGIN_SEG_NAME=#{originSegName},   <!-- 来源线段名称 -->
        </if>
        <if test="useLineNo!=null">
            USE_LINE_NO=#{useLineNo},   <!-- 应用线别代码 -->
        </if>
        <if test="useLineName!=null">
            USE_LINE_NAME=#{useLineName},   <!-- 应用线别 -->
        </if>
        <if test="useSegNo!=null">
            USE_SEG_NO=#{useSegNo},   <!-- 应用线段代码 -->
        </if>
        <if test="useSegName!=null">
            USE_SEG_NAME=#{useSegName},   <!-- 应用线段 -->
        </if>
        <if test="position1Code!=null">
            POSITION1_CODE=#{position1Code},   <!-- 位置一 -->
        </if>
        <if test="position1Name!=null">
            POSITION1_NAME=#{position1Name},   <!-- 位置一名称 -->
        </if>
        <if test="position2Code!=null">
            POSITION2_CODE=#{position2Code},   <!-- 位置二 -->
        </if>
        <if test="position2Name!=null">
            POSITION2_NAME=#{position2Name},   <!-- 位置二名称 -->
        </if>
        <if test="position3!=null">
            POSITION3=#{position3},   <!-- 位置三 -->
        </if>
        <if test="positionRemark!=null">
            POSITION_REMARK=#{positionRemark},   <!-- 位置补充说明 -->
        </if>
        <if test="totalMiles!=null">
            TOTAL_MILES=#{totalMiles,jdbcType=NUMERIC},   <!-- 走行里程 -->
        </if>
        <if test="remark!=null">
            REMARK=#{remark},   <!-- 备注 -->
        </if>
        <if test="approvalStatus!=null">
            APPROVAL_STATUS=#{approvalStatus},   <!-- 审批状态 -->
        </if>
        <if test="workFlowInstId!=null">
            WORK_FLOW_INST_ID=#{workFlowInstId},   <!-- 工作流实例ID -->
        </if>
        <if test="workFlowInstStatus!=null">
            WORK_FLOW_INST_STATUS=#{workFlowInstStatus},   <!-- 工作流实例状态 -->
        </if>
        <if test="verifyDate!=null">
            VERIFY_DATE=#{verifyDate},   <!-- 特种设备检测日期 -->
        </if>
        <if test="verifyValidityDate!=null">
            VERIFY_VALIDITY_DATE=#{verifyValidityDate},   <!-- 特种设备检测有效期 -->
        </if>
        <if test="archiveFlag!=null">
            ARCHIVE_FLAG=#{archiveFlag},   <!-- 归档标记 -->
        </if>
        <if test="recStatus!=null">
            REC_STATUS=#{recStatus},   <!-- 记录状态 -->
        </if>
        <if test="ext1!=null">
            EXT1=#{ext1},   <!-- 扩展字段1 -->
        </if>
        <if test="ext2!=null">
            EXT2=#{ext2},   <!-- 扩展字段2 -->
        </if>
        <if test="ext3!=null">
            EXT3=#{ext3},   <!-- 扩展字段3 -->
        </if>
        <if test="ext4!=null">
            EXT4=#{ext4},   <!-- 扩展字段4 -->
        </if>
        <if test="ext5!=null">
            EXT5=#{ext5},  <!-- 扩展字段5 -->
        </if>
        REC_REVISOR=#{recRevisor},   <!-- 修改者 -->
        REC_REVISE_TIME=#{recReviseTime}   <!-- 修改时间 -->
        WHERE REC_ID = #{recId}
    </update>

    <select id="listOverhaul" resultType="com.wzmtr.eam.dto.res.overhaul.OverhaulOrderDetailResDTO">
        SELECT
        REC_ID	as "recId",  <!-- 记录ID -->
        ORDER_CODE	as "orderCode",  <!-- 检修工单 -->
        OBJECT_CODE	as "objectCode",  <!-- 对象编码 -->
        OBJECT_NAME	as "objectName",  <!-- 对象名称 -->
        REPAIR_STATUS	as "repairStatus",  <!-- 检修情况 -->
        REPAIR_DETAIL	as "repairDetail",  <!-- 检修情况说明 -->
        START_TIME	as "startTime",  <!-- 开始时间 -->
        COMPLITE_TIME	as "compliteTime",  <!-- 结束时间 -->
        ABNORMAL_NUMBER	as "abnormalNumber" <!-- 异常数量 -->
        FROM T_OVERHAUL_ORDER_DETAIL WHERE 1=1 AND OBJECT_CODE=#{equipCode}
        order by ORDER_CODE desc
    </select>

    <select id="listFault" resultType="com.wzmtr.eam.dto.res.fault.FaultDetailResDTO">
        SELECT
        a.DISCOVERER_NAME as "discovererName",
        a.DISCOVERY_TIME as "discoveryTime",
        a.FAULT_DETAIL as "faultDisplayDetail",
        b.FAULT_REASON_DETAIL as "faultReasonDetail",
        b.FAULT_ACTION_DETAIL as "faultActionDetail",
        b.REPAIR_END_TIME as "repairEndTime"
        FROM T_FAULT_INFO a
        LEFT JOIN T_FAULT_ORDER b ON a.FAULT_NO=b.FAULT_NO
        WHERE 1=1 AND a.OBJECT_CODE=#{equipCode}
        order by a.FAULT_NO desc
    </select>

    <select id="listPartReplace" resultType="com.wzmtr.eam.dto.res.equipment.PartReplaceResDTO">
        SELECT
        REC_ID	as "recId",  <!-- 记录编号 -->
        FAULT_WORK_NO	as "faultWorkNo",  <!-- 故障工单编号 -->
        EQUIP_CODE	as "equipCode",  <!-- 设备代码 -->
        EQUIP_NAME	as "equipName",  <!-- 设备名称 -->
        ORG_TYPE	as "orgType",  <!-- 作业单位 -->
        OPERATOR	as "operator",  <!-- 作业人员 -->
        REPLACEMENT_NO	as "replacementNo",  <!-- 更换配件代码 -->
        REPLACEMENT_NAME	as "replacementName",  <!-- 更换配件名称 -->
        REPLACE_REASON	as "replaceReason",  <!-- 更换原因 -->
        OLD_REP_NO	as "oldRepNo",  <!-- 旧配件编号 -->
        NEW_REP_NO	as "newRepNo",  <!-- 新配件编号 -->
        OPERATE_COST_TIME	as "operateCostTime",  <!-- 更换所用时间 -->
        REPLACE_DATE	as "replaceDate",  <!-- 处理日期 -->
        REMARK	as "remark",  <!-- 备注 -->
        DOC_ID	as "docId",  <!-- 附件编号 -->
        REC_CREATOR	as "recCreator",  <!-- 创建者 -->
        REC_CREATE_TIME	as "recCreateTime",  <!-- 创建时间 -->
        REC_REVISOR	as "recRevisor",  <!-- 修改者 -->
        REC_REVISE_TIME	as "recReviseTime",  <!-- 修改时间 -->
        REC_DELETOR	as "recDeletor",  <!-- 删除者 -->
        REC_DELETE_TIME	as "recDeleteTime",  <!-- 删除时间 -->
        DELETE_FLAG	as "deleteFlag",  <!-- 删除标志 -->
        ARCHIVE_FLAG	as "archiveFlag",  <!-- 归档标记 -->
        REC_STATUS	as "recStatus",  <!-- 记录状态 -->
        EXT1	as "ext1",  <!-- 扩展字段1 -->
        EXT2	as "ext2",  <!-- 扩展字段2 -->
        EXT3	as "ext3",  <!-- 扩展字段3 -->
        EXT4	as "ext4",  <!-- 扩展字段4 -->
        EXT5	as "ext5",  <!-- 扩展字段5 -->
        EXT6	as "ext6",  <!-- 扩展字段6 -->
        EXT7	as "ext7" <!-- 扩展字段7 -->
        FROM T_PART_REPLACEMENT
        WHERE 1=1 and DELETE_FLAG='0' AND EQUIP_CODE=#{equipCode}
        ORDER BY REPLACE_DATE desc, REC_CREATE_TIME desc
    </select>
    <select id="queryLine" resultType="com.wzmtr.eam.dto.res.basic.LineResDTO">
        SELECT
        db.LINE_CODE as "lineCode",
        ec.ITEM_CNAME as "lineName"
        FROM SYS_REGION db,SYS_DICT ec
        where db.LINE_CODE = ec.ITEM_CODE and ec.CODESET_CODE='line'
        <if test="recId!=null">
           and db.REC_ID = #{recId}
        </if>
        order by db.NODE_CODE asc
    </select>
    <select id="queryCarLine" resultType="com.wzmtr.eam.dto.res.basic.LineResDTO">
        SELECT
        ITEM_CODE as "lineCode",
        ITEM_CNAME as "lineName"
        FROM SYS_DICT
        where CODESET_CODE='line'
        <if test="lineCode!=null">
            and ITEM_CODE=#{lineCode}
        </if>
    </select>

    <select id="getEquipByName" resultType="com.wzmtr.eam.dto.res.equipment.EquipmentResDTO">
        <include refid="equip-cols"/>
        FROM T_EQUIPMENT WHERE EQUIP_NAME=#{name} AND DELETE_FLAG='0'
        AND ROWNUM=1
    </select>


</mapper>